<!DOCTYPE html>
<html>
<head>
    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/css/luckysheet.css"
    />
    <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/assets/iconfont/iconfont.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/plugins/js/plugin.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/luckysheet@2.1.13/dist/luckysheet.umd.js"></script>
</head>

<body>
<div
        id="luckysheet"
        style="
        margin: 0px;
        padding: 0px;
        position: absolute;
        width: 100%;
        height: 100%;
        left: 0px;
        top: 0px;
      "
></div>
<script type="text/javascript">
  (function () {
    window.addEventListener('message', (e) => {
      // const data = JSON.parse(e.data);

      if (e.data.action === 'content') {

        var options = {
          container: 'luckysheet',
          showinfobar: false,
          showstatisticBar: false,
          sheetFormulaBar: false,
          allowUpdate: false,
          showsheetbar: false,
          row: 100,
          column: 20,
          showtoolbarConfig: {
            currencyFormat: false,
            paintFormat: false,
            numberDecrease: false, //'Decrease the number of decimal places'
            numberIncrease: false, //'Increase the number of decimal places
            verticalAlignMode: false,
            textRotateMode: false, //'Text Rotation Mode'
            image: false, // 'Insert picture'
            link: false, // 'Insert link'
            chart: false, //'chart' (the icon is hidden, but if the chart plugin is configured, you can still create a new chart by right click)
            postil: false, //'comment'
            pivotTable: false, //'PivotTable'
            function: false, //'formula'
            frozenMode: false, //'freeze mode'
            sortAndFilter: false, //'Sort and filter'
            conditionalFormat: false, //'Conditional Format'
            dataVerification: false, // 'Data Verification'
            splitColumn: false, //'Split column'
            screenshot: false, //'screenshot'
            findAndReplace: false, //'Find and Replace'
            protection: false, // 'Worksheet protection'
            print: false, // 'Print'
          },
          cellRightClickConfig: {
            image: false,
            chart: false
          },
          data: e.data.content || null,
          hook: {
            updated: () => {
              window.parent.postMessage({
                action: 'save',
                content: luckysheet.getAllSheets()
              });
            }
          }
        };
        luckysheet.create(options);
      }
    });
    window.parent.postMessage({action: 'loaded'}, '*');

  })();
</script>
</body>
</html>
